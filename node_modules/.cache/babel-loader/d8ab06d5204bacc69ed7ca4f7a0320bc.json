{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _cssVendor = require(\"css-vendor\");\n\nvar cssVendor = _interopRequireWildcard(_cssVendor);\n\nvar _debug = require(\"debug\");\n\nvar _debug2 = _interopRequireDefault(_debug);\n\nvar _lodash = require(\"lodash.throttle\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require(\"react-dom\");\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _layout = require(\"./layout\");\n\nvar _layout2 = _interopRequireDefault(_layout);\n\nvar _onResize = require(\"./on-resize\");\n\nvar _onResize2 = _interopRequireDefault(_onResize);\n\nvar _platform = require(\"./platform\");\n\nvar _platform2 = _interopRequireDefault(_platform);\n\nvar _tip = require(\"./tip\");\n\nvar _tip2 = _interopRequireDefault(_tip);\n\nvar _utils = require(\"./utils\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar log = (0, _debug2.default)(\"react-popover\");\n\nvar supportedCSSValue = _utils2.default.clientOnly(cssVendor.supportedValue);\n\nvar jsprefix = function jsprefix(x) {\n  return \"\" + cssVendor.prefix.js + x;\n};\n\nvar cssprefix = function cssprefix(x) {\n  return \"\" + cssVendor.prefix.css + x;\n};\n\nvar cssvalue = function cssvalue(prop, value) {\n  return supportedCSSValue(prop, value) || cssprefix(value);\n};\n\nvar coreStyle = {\n  position: \"absolute\",\n  top: 0,\n  left: 0,\n  display: cssvalue(\"display\", \"flex\")\n};\nvar faces = {\n  above: \"down\",\n  right: \"left\",\n  below: \"up\",\n  left: \"right\"\n  /* Flow mappings. Each map maps the flow domain to another domain. */\n\n};\nvar flowToTipTranslations = {\n  row: \"translateY\",\n  column: \"translateX\"\n};\nvar flowToPopoverTranslations = {\n  row: \"translateX\",\n  column: \"translateY\"\n};\n\nvar Popover = function (_React$Component) {\n  _inherits(Popover, _React$Component);\n\n  function Popover(props) {\n    _classCallCheck(this, Popover);\n\n    var _this = _possibleConstructorReturn(this, (Popover.__proto__ || Object.getPrototypeOf(Popover)).call(this, props));\n\n    _this.checkTargetReposition = function () {\n      if (_this.measureTargetBounds()) _this.resolvePopoverLayout();\n    };\n\n    _this.checkForOuterAction = function (event) {\n      var isOuterAction = !_this.containerEl.contains(event.target) && !_this.targetEl.contains(event.target);\n      if (isOuterAction) _this.props.onOuterAction(event);\n    };\n\n    _this.onTargetResize = function () {\n      log(\"Recalculating layout because _target_ resized!\");\n\n      _this.measureTargetBounds();\n\n      _this.resolvePopoverLayout();\n    };\n\n    _this.onPopoverResize = function () {\n      log(\"Recalculating layout because _popover_ resized!\");\n\n      _this.measurePopoverSize();\n\n      _this.resolvePopoverLayout();\n    };\n\n    _this.onFrameScroll = function () {\n      log(\"Recalculating layout because _frame_ scrolled!\");\n\n      _this.measureTargetBounds();\n\n      _this.resolvePopoverLayout();\n    };\n\n    _this.onFrameResize = function () {\n      log(\"Recalculating layout because _frame_ resized!\");\n\n      _this.measureFrameBounds();\n\n      _this.resolvePopoverLayout();\n    };\n\n    _this.getContainerNodeRef = function (containerEl) {\n      Object.assign(_this, {\n        containerEl: containerEl\n      });\n    };\n\n    _this.state = {\n      standing: \"above\",\n      exited: !_this.props.isOpen,\n      // for animation-dependent rendering, should popover close/open?\n      exiting: false,\n      // for tracking in-progress animations\n      toggle: _this.props.isOpen || false // for business logic tracking, should popover close/open?\n\n    };\n    return _this;\n  }\n\n  _createClass(Popover, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      /* Our component needs a DOM Node reference to the child so that it can be\n      measured so that we can correctly layout the popover. We do not have any\n      control over the child so cannot leverage refs. We could wrap our own\n      primitive component around the child but that could lead to breaking the\n      uses layout (e.g. the child is a flex item). Leveraging findDOMNode seems\n      to be the only functional solution, despite all the general warnings not to\n      use it. We have a legitimate use-case. */\n      // eslint-disable-next-line\n      this.targetEl = _reactDom2.default.findDOMNode(this);\n      if (this.props.isOpen) this.enter();\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(propsNext) {\n      //log(`Component received props!`, propsNext)\n      var willOpen = !this.props.isOpen && propsNext.isOpen;\n      var willClose = this.props.isOpen && !propsNext.isOpen;\n      if (willOpen) this.open();else if (willClose) this.close();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(propsPrev, statePrev) {\n      //log(`Component did update!`)\n      var didOpen = !statePrev.toggle && this.state.toggle;\n      var didClose = statePrev.toggle && !this.state.toggle;\n      if (didOpen) this.enter();else if (didClose) this.exit();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      /* If the Popover is unmounted while animating,\n      clear the animation so no setState occured */\n      this.animateExitStop();\n      /* If the Popover was never opened then then tracking\n      initialization never took place and so calling untrack\n      would be an error. Also see issue 55. */\n\n      if (this.hasTracked) this.untrackPopover();\n    }\n  }, {\n    key: \"resolvePopoverLayout\",\n    value: function resolvePopoverLayout() {\n      /* Find the optimal zone to position self. Measure the size of each zone and use the one with\n      the greatest area. */\n      var pickerSettings = {\n        preferPlace: this.props.preferPlace,\n        place: this.props.place\n        /* This is a kludge that solves a general problem very specifically for Popover.\n        The problem is subtle. When Popover positioning changes such that it resolves at\n        a different orientation, its Size will change because the Tip will toggle between\n        extending Height or Width. The general problem of course is that calculating\n        zone positioning based on current size is non-trivial if the Size can change once\n        resolved to a different zone. Infinite recursion can be triggered as we noted here:\n        https://github.com/littlebits/react-popover/issues/18. As an example of how this\n        could happen in another way: Imagine the user changes the CSS styling of the popover\n        based on whether it was `row` or `column` flow. TODO: Find a solution to generally\n        solve this problem so that the user is free to change the Popover styles in any\n        way at any time for any arbitrary trigger. There may be value in investigating the\n        http://overconstrained.io community for its general layout system via the\n        constraint-solver Cassowary. */\n\n      };\n      if (this.zone) this.size[this.zone.flow === \"row\" ? \"h\" : \"w\"] += this.props.tipSize;\n\n      var zone = _layout2.default.pickZone(pickerSettings, this.frameBounds, this.targetBounds, this.size);\n\n      if (this.zone) this.size[this.zone.flow === \"row\" ? \"h\" : \"w\"] -= this.props.tipSize;\n      var tb = this.targetBounds;\n      this.zone = zone;\n      log(\"zone\", zone);\n      this.setState({\n        standing: zone.standing\n      });\n      var axis = _layout2.default.axes[zone.flow];\n      log(\"axes\", axis);\n      var dockingEdgeBufferLength = Math.round(getComputedStyle(this.bodyEl).borderRadius.slice(0, -2)) || 0;\n\n      var scrollSize = _layout2.default.El.calcScrollSize(this.frameEl);\n\n      scrollSize.main = scrollSize[axis.main.size];\n      scrollSize.cross = scrollSize[axis.cross.size];\n      /* When positioning self on the cross-axis do not exceed frame bounds. The strategy to achieve\n      this is thus: First position cross-axis self to the cross-axis-center of the the target. Then,\n      offset self by the amount that self is past the boundaries of frame. */\n\n      var pos = _layout2.default.calcRelPos(zone, tb, this.size);\n      /* Offset allows users to control the distance betweent the tip and the target. */\n\n\n      pos[axis.main.start] += this.props.offset * zone.order;\n      /* Constrain containerEl Position within frameEl. Try not to penetrate a visually-pleasing buffer from\n      frameEl. `frameBuffer` length is based on tipSize and its offset. */\n\n      var frameBuffer = this.props.tipSize + this.props.offset;\n      var hangingBufferLength = dockingEdgeBufferLength * 2 + this.props.tipSize * 2 + frameBuffer;\n      var frameCrossStart = this.frameBounds[axis.cross.start];\n      var frameCrossEnd = this.frameBounds[axis.cross.end];\n      var frameCrossLength = this.frameBounds[axis.cross.size];\n      var frameCrossInnerLength = frameCrossLength - frameBuffer * 2;\n      var frameCrossInnerStart = frameCrossStart + frameBuffer;\n      var frameCrossInnerEnd = frameCrossEnd - frameBuffer;\n      var popoverCrossStart = pos[axis.cross.start];\n      var popoverCrossEnd = pos[axis.cross.end];\n      /* If the popover dose not fit into frameCrossLength then just position it to the `frameCrossStart`.\n      popoverCrossLength` will now be forced to overflow into the `Frame` */\n\n      if (pos.crossLength > frameCrossLength) {\n        log(\"popoverCrossLength does not fit frame.\");\n        pos[axis.cross.start] = 0;\n        /* If the `popoverCrossStart` is forced beyond some threshold of `targetCrossLength` then bound\n        it (`popoverCrossStart`). */\n      } else if (tb[axis.cross.end] < hangingBufferLength) {\n        log(\"popoverCrossStart cannot hang any further without losing target.\");\n        pos[axis.cross.start] = tb[axis.cross.end] - hangingBufferLength;\n        /* checking if the cross start of the target area is within the frame and it makes sense\n        to try fitting popover into the frame. */\n      } else if (tb[axis.cross.start] > frameCrossInnerEnd) {\n        log(\"popoverCrossStart cannot hang any further without losing target.\");\n        pos[axis.cross.start] = tb[axis.cross.start] - this.size[axis.cross.size];\n        /* If the `popoverCrossStart` does not fit within the inner frame (honouring buffers) then\n        just center the popover in the remaining `frameCrossLength`. */\n      } else if (pos.crossLength > frameCrossInnerLength) {\n        log(\"popoverCrossLength does not fit within buffered frame.\");\n        pos[axis.cross.start] = (frameCrossLength - pos.crossLength) / 2;\n      } else if (popoverCrossStart < frameCrossInnerStart) {\n        log(\"popoverCrossStart cannot reverse without exceeding frame.\");\n        pos[axis.cross.start] = frameCrossInnerStart;\n      } else if (popoverCrossEnd > frameCrossInnerEnd) {\n        log(\"popoverCrossEnd cannot travel without exceeding frame.\");\n        pos[axis.cross.start] = pos[axis.cross.start] - (pos[axis.cross.end] - frameCrossInnerEnd);\n      }\n      /* So far the link position has been calculated relative to the target. To calculate the absolute\n      position we need to factor the `Frame``s scroll position */\n\n\n      pos[axis.cross.start] += scrollSize.cross;\n      pos[axis.main.start] += scrollSize.main;\n      /* Apply `flow` and `order` styles. This can impact subsequent measurements of height and width\n      of the container. When tip changes orientation position due to changes from/to `row`/`column`\n      width`/`height` will be impacted. Our layout monitoring will catch these cases and automatically\n      recalculate layout. */\n\n      if (this.containerEl) {\n        this.containerEl.style.flexFlow = zone.flow;\n        this.containerEl.style[jsprefix(\"FlexFlow\")] = this.containerEl.style.flexFlow;\n      }\n\n      this.bodyEl.style.order = zone.order;\n      this.bodyEl.style[jsprefix(\"Order\")] = this.bodyEl.style.order;\n      /* Apply Absolute Positioning. */\n\n      log(\"pos\", pos);\n\n      if (this.containerEl) {\n        this.containerEl.style.top = pos.y + \"px\";\n        this.containerEl.style.left = pos.x + \"px\";\n      }\n      /* Calculate Tip Position */\n\n\n      var tipCrossPos =\n      /* Get the absolute tipCrossCenter. Tip is positioned relative to containerEl\n      but it aims at targetCenter which is positioned relative to frameEl... we\n      need to cancel the containerEl positioning so as to hit our intended position. */\n      _layout2.default.centerOfBoundsFromBounds(zone.flow, \"cross\", tb, pos) +\n      /* centerOfBounds does not account for scroll so we need to manually add that\n      here. */\n      scrollSize.cross -\n      /* Center tip relative to self. We do not have to calcualte half-of-tip-size since tip-size\n      specifies the length from base to tip which is half of total length already. */\n      this.props.tipSize;\n      if (tipCrossPos < dockingEdgeBufferLength) tipCrossPos = dockingEdgeBufferLength;else if (tipCrossPos > pos.crossLength - dockingEdgeBufferLength - this.props.tipSize * 2) {\n        tipCrossPos = pos.crossLength - dockingEdgeBufferLength - this.props.tipSize * 2;\n      }\n      this.tipEl.style.transform = flowToTipTranslations[zone.flow] + \"(\" + tipCrossPos + \"px)\";\n      this.tipEl.style[jsprefix(\"Transform\")] = this.tipEl.style.transform;\n    }\n  }, {\n    key: \"measurePopoverSize\",\n    value: function measurePopoverSize() {\n      this.size = _layout2.default.El.calcSize(this.containerEl);\n    }\n  }, {\n    key: \"measureTargetBounds\",\n    value: function measureTargetBounds() {\n      var newTargetBounds = _layout2.default.El.calcBounds(this.targetEl);\n\n      if (this.targetBounds && _layout2.default.equalCoords(this.targetBounds, newTargetBounds)) {\n        return false;\n      }\n\n      this.targetBounds = newTargetBounds;\n      return true;\n    }\n  }, {\n    key: \"open\",\n    value: function open() {\n      if (this.state.exiting) this.animateExitStop();\n      this.setState({\n        toggle: true,\n        exited: false\n      });\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.setState({\n        toggle: false\n      });\n    }\n  }, {\n    key: \"enter\",\n    value: function enter() {\n      if (_platform2.default.isServer) return;\n      log(\"enter!\");\n      this.trackPopover();\n      this.animateEnter();\n    }\n  }, {\n    key: \"exit\",\n    value: function exit() {\n      log(\"exit!\");\n      this.animateExit();\n      this.untrackPopover();\n    }\n  }, {\n    key: \"animateExitStop\",\n    value: function animateExitStop() {\n      clearTimeout(this.exitingAnimationTimer1);\n      clearTimeout(this.exitingAnimationTimer2);\n      this.setState({\n        exiting: false\n      });\n    }\n  }, {\n    key: \"animateExit\",\n    value: function animateExit() {\n      var _this2 = this;\n\n      this.setState({\n        exiting: true\n      });\n      this.exitingAnimationTimer2 = setTimeout(function () {\n        setTimeout(function () {\n          if (_this2.containerEl) {\n            _this2.containerEl.style.transform = flowToPopoverTranslations[_this2.zone.flow] + \"(\" + _this2.zone.order * 50 + \"px)\";\n            _this2.containerEl.style.opacity = \"0\";\n          }\n        }, 0);\n      }, 0);\n      this.exitingAnimationTimer1 = setTimeout(function () {\n        _this2.setState({\n          exited: true,\n          exiting: false\n        });\n      }, this.props.enterExitTransitionDurationMs);\n    }\n  }, {\n    key: \"animateEnter\",\n    value: function animateEnter() {\n      /* Prepare `entering` style so that we can then animate it toward `entered`. */\n      this.containerEl.style.transform = flowToPopoverTranslations[this.zone.flow] + \"(\" + this.zone.order * 50 + \"px)\";\n      this.containerEl.style[jsprefix(\"Transform\")] = this.containerEl.style.transform;\n      this.containerEl.style.opacity = \"0\";\n      /* After initial layout apply transition animations. */\n\n      /* Hack: http://stackoverflow.com/questions/3485365/how-can-i-force-webkit-to-redraw-repaint-to-propagate-style-changes */\n\n      this.containerEl.offsetHeight;\n      /* If enterExitTransitionDurationMs is falsy, tip animation should be also disabled */\n\n      if (this.props.enterExitTransitionDurationMs) {\n        this.tipEl.style.transition = \"transform 150ms ease-in\";\n        this.tipEl.style[jsprefix(\"Transition\")] = cssprefix(\"transform\") + \" 150ms ease-in\";\n      }\n\n      this.containerEl.style.transitionProperty = \"top, left, opacity, transform\";\n      this.containerEl.style.transitionDuration = this.props.enterExitTransitionDurationMs + \"ms\";\n      this.containerEl.style.transitionTimingFunction = \"cubic-bezier(0.230, 1.000, 0.320, 1.000)\";\n      this.containerEl.style.opacity = \"1\";\n      this.containerEl.style.transform = \"translateY(0)\";\n      this.containerEl.style[jsprefix(\"Transform\")] = this.containerEl.style.transform;\n    }\n  }, {\n    key: \"trackPopover\",\n    value: function trackPopover() {\n      var minScrollRefreshIntervalMs = 200;\n      var minResizeRefreshIntervalMs = 200;\n      /* Get references to DOM elements. */\n\n      this.bodyEl = this.containerEl.querySelector(\".Popover-body\");\n      this.tipEl = this.containerEl.querySelector(\".Popover-tip\");\n      /* Note: frame is hardcoded to window now but we think it will\n      be a nice feature in the future to allow other frames to be used\n      such as local elements that further constrain the popover`s world. */\n\n      this.frameEl = _platform2.default.window;\n      this.hasTracked = true;\n      /* Set a general interval for checking if target position changed. There is no way\n      to know this information without polling. */\n\n      if (this.props.refreshIntervalMs) {\n        this.checkLayoutInterval = setInterval(this.checkTargetReposition, this.props.refreshIntervalMs);\n      }\n      /* Watch for boundary changes in all deps, and when one of them changes, recalculate layout.\n      This layout monitoring must be bound immediately because a layout recalculation can recursively\n      cause a change in boundaries. So if we did a one-time force-layout before watching boundaries\n      our final position calculations could be wrong. See comments in resolver function for details\n      about which parts can trigger recursive recalculation. */\n\n\n      this.onFrameScroll = (0, _lodash2.default)(this.onFrameScroll, minScrollRefreshIntervalMs);\n      this.onFrameResize = (0, _lodash2.default)(this.onFrameResize, minResizeRefreshIntervalMs);\n      this.onPopoverResize = (0, _lodash2.default)(this.onPopoverResize, minResizeRefreshIntervalMs);\n      this.onTargetResize = (0, _lodash2.default)(this.onTargetResize, minResizeRefreshIntervalMs);\n      this.frameEl.addEventListener(\"scroll\", this.onFrameScroll);\n\n      _onResize2.default.on(this.frameEl, this.onFrameResize);\n\n      _onResize2.default.on(this.containerEl, this.onPopoverResize);\n\n      _onResize2.default.on(this.targetEl, this.onTargetResize);\n      /* Track user actions on the page. Anything that occurs _outside_ the Popover boundaries\n      should close the Popover. */\n\n\n      _platform2.default.document.addEventListener(\"mousedown\", this.checkForOuterAction);\n\n      _platform2.default.document.addEventListener(\"touchstart\", this.checkForOuterAction);\n      /* Kickstart layout at first boot. */\n\n\n      this.measurePopoverSize();\n      this.measureFrameBounds();\n      this.measureTargetBounds();\n      this.resolvePopoverLayout();\n    }\n  }, {\n    key: \"untrackPopover\",\n    value: function untrackPopover() {\n      clearInterval(this.checkLayoutInterval);\n      this.frameEl.removeEventListener(\"scroll\", this.onFrameScroll);\n\n      _onResize2.default.off(this.frameEl, this.onFrameResize);\n\n      _onResize2.default.off(this.containerEl, this.onPopoverResize);\n\n      _onResize2.default.off(this.targetEl, this.onTargetResize);\n\n      _platform2.default.document.removeEventListener(\"mousedown\", this.checkForOuterAction);\n\n      _platform2.default.document.removeEventListener(\"touchstart\", this.checkForOuterAction);\n\n      this.hasTracked = false;\n    }\n  }, {\n    key: \"measureFrameBounds\",\n    value: function measureFrameBounds() {\n      this.frameBounds = _layout2.default.El.calcBounds(this.frameEl);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _props = this.props,\n          _props$className = _props.className,\n          className = _props$className === undefined ? \"\" : _props$className,\n          _props$style = _props.style,\n          style = _props$style === undefined ? {} : _props$style,\n          tipSize = _props.tipSize;\n      var standing = this.state.standing;\n      var popoverProps = {\n        className: \"Popover Popover-\" + standing + \" \" + className,\n        style: _extends({}, coreStyle, style)\n      };\n      var popover = this.state.exited ? null : _react2.default.createElement(\"div\", _extends({\n        ref: this.getContainerNodeRef\n      }, popoverProps), _react2.default.createElement(\"div\", {\n        className: \"Popover-body\",\n        children: this.props.body\n      }), _react2.default.createElement(_tip2.default, {\n        direction: faces[standing],\n        size: tipSize\n      }));\n      return [this.props.children, _platform2.default.isClient && _reactDom2.default.createPortal(popover, this.props.appendTarget)];\n    }\n  }]);\n\n  return Popover;\n}(_react2.default.Component);\n\nPopover.propTypes = {\n  body: _propTypes2.default.node.isRequired,\n  children: _propTypes2.default.element.isRequired,\n  appendTarget: _propTypes2.default.object,\n  className: _propTypes2.default.string,\n  enterExitTransitionDurationMs: _propTypes2.default.number,\n  isOpen: _propTypes2.default.bool,\n  offset: _propTypes2.default.number,\n  place: _propTypes2.default.oneOf(_layout2.default.validTypeValues),\n  preferPlace: _propTypes2.default.oneOf(_layout2.default.validTypeValues),\n  refreshIntervalMs: _propTypes2.default.oneOfType([_propTypes2.default.number, _propTypes2.default.bool]),\n  style: _propTypes2.default.object,\n  tipSize: _propTypes2.default.number,\n  onOuterAction: _propTypes2.default.func\n};\nPopover.defaultProps = {\n  tipSize: 7,\n  preferPlace: null,\n  place: null,\n  offset: 4,\n  isOpen: false,\n  onOuterAction: _utils2.default.noop,\n  enterExitTransitionDurationMs: 500,\n  children: null,\n  refreshIntervalMs: 200,\n  appendTarget: _platform2.default.isClient ? _platform2.default.document.body : null\n};\nexports.default = Popover;","map":{"version":3,"sources":["E:/project/front/tmd/node_modules/react-popover/build/index.js"],"names":["Object","defineProperty","exports","value","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","_cssVendor","require","cssVendor","_interopRequireWildcard","_debug","_debug2","_interopRequireDefault","_lodash","_lodash2","_propTypes","_propTypes2","_react","_react2","_reactDom","_reactDom2","_layout","_layout2","_onResize","_onResize2","_platform","_platform2","_tip","_tip2","_utils","_utils2","obj","__esModule","default","newObj","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","log","supportedCSSValue","clientOnly","supportedValue","jsprefix","x","prefix","js","cssprefix","css","cssvalue","prop","coreStyle","position","top","left","display","faces","above","right","below","flowToTipTranslations","row","column","flowToPopoverTranslations","Popover","_React$Component","_this","getPrototypeOf","checkTargetReposition","measureTargetBounds","resolvePopoverLayout","checkForOuterAction","event","isOuterAction","containerEl","contains","targetEl","onOuterAction","onTargetResize","onPopoverResize","measurePopoverSize","onFrameScroll","onFrameResize","measureFrameBounds","getContainerNodeRef","state","standing","exited","isOpen","exiting","toggle","componentDidMount","findDOMNode","enter","componentWillReceiveProps","propsNext","willOpen","willClose","open","close","componentDidUpdate","propsPrev","statePrev","didOpen","didClose","exit","componentWillUnmount","animateExitStop","hasTracked","untrackPopover","pickerSettings","preferPlace","place","zone","size","flow","tipSize","pickZone","frameBounds","targetBounds","tb","setState","axis","axes","dockingEdgeBufferLength","Math","round","getComputedStyle","bodyEl","borderRadius","slice","scrollSize","El","calcScrollSize","frameEl","main","cross","pos","calcRelPos","start","offset","order","frameBuffer","hangingBufferLength","frameCrossStart","frameCrossEnd","end","frameCrossLength","frameCrossInnerLength","frameCrossInnerStart","frameCrossInnerEnd","popoverCrossStart","popoverCrossEnd","crossLength","style","flexFlow","y","tipCrossPos","centerOfBoundsFromBounds","tipEl","transform","calcSize","newTargetBounds","calcBounds","equalCoords","isServer","trackPopover","animateEnter","animateExit","clearTimeout","exitingAnimationTimer1","exitingAnimationTimer2","_this2","setTimeout","opacity","enterExitTransitionDurationMs","offsetHeight","transition","transitionProperty","transitionDuration","transitionTimingFunction","minScrollRefreshIntervalMs","minResizeRefreshIntervalMs","querySelector","window","refreshIntervalMs","checkLayoutInterval","setInterval","addEventListener","on","document","clearInterval","removeEventListener","off","render","_props","_props$className","className","undefined","_props$style","popoverProps","popover","createElement","ref","children","body","direction","isClient","createPortal","appendTarget","Component","propTypes","node","isRequired","element","object","string","number","bool","oneOf","validTypeValues","oneOfType","func","defaultProps","noop"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _cssVendor = require(\"css-vendor\");\n\nvar cssVendor = _interopRequireWildcard(_cssVendor);\n\nvar _debug = require(\"debug\");\n\nvar _debug2 = _interopRequireDefault(_debug);\n\nvar _lodash = require(\"lodash.throttle\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require(\"react-dom\");\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _layout = require(\"./layout\");\n\nvar _layout2 = _interopRequireDefault(_layout);\n\nvar _onResize = require(\"./on-resize\");\n\nvar _onResize2 = _interopRequireDefault(_onResize);\n\nvar _platform = require(\"./platform\");\n\nvar _platform2 = _interopRequireDefault(_platform);\n\nvar _tip = require(\"./tip\");\n\nvar _tip2 = _interopRequireDefault(_tip);\n\nvar _utils = require(\"./utils\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar log = (0, _debug2.default)(\"react-popover\");\n\nvar supportedCSSValue = _utils2.default.clientOnly(cssVendor.supportedValue);\n\nvar jsprefix = function jsprefix(x) {\n  return \"\" + cssVendor.prefix.js + x;\n};\n\nvar cssprefix = function cssprefix(x) {\n  return \"\" + cssVendor.prefix.css + x;\n};\n\nvar cssvalue = function cssvalue(prop, value) {\n  return supportedCSSValue(prop, value) || cssprefix(value);\n};\n\nvar coreStyle = {\n  position: \"absolute\",\n  top: 0,\n  left: 0,\n  display: cssvalue(\"display\", \"flex\")\n};\n\nvar faces = {\n  above: \"down\",\n  right: \"left\",\n  below: \"up\",\n  left: \"right\"\n\n  /* Flow mappings. Each map maps the flow domain to another domain. */\n\n};var flowToTipTranslations = {\n  row: \"translateY\",\n  column: \"translateX\"\n};\n\nvar flowToPopoverTranslations = {\n  row: \"translateX\",\n  column: \"translateY\"\n};\n\nvar Popover = function (_React$Component) {\n  _inherits(Popover, _React$Component);\n\n  function Popover(props) {\n    _classCallCheck(this, Popover);\n\n    var _this = _possibleConstructorReturn(this, (Popover.__proto__ || Object.getPrototypeOf(Popover)).call(this, props));\n\n    _this.checkTargetReposition = function () {\n      if (_this.measureTargetBounds()) _this.resolvePopoverLayout();\n    };\n\n    _this.checkForOuterAction = function (event) {\n      var isOuterAction = !_this.containerEl.contains(event.target) && !_this.targetEl.contains(event.target);\n      if (isOuterAction) _this.props.onOuterAction(event);\n    };\n\n    _this.onTargetResize = function () {\n      log(\"Recalculating layout because _target_ resized!\");\n      _this.measureTargetBounds();\n      _this.resolvePopoverLayout();\n    };\n\n    _this.onPopoverResize = function () {\n      log(\"Recalculating layout because _popover_ resized!\");\n      _this.measurePopoverSize();\n      _this.resolvePopoverLayout();\n    };\n\n    _this.onFrameScroll = function () {\n      log(\"Recalculating layout because _frame_ scrolled!\");\n      _this.measureTargetBounds();\n      _this.resolvePopoverLayout();\n    };\n\n    _this.onFrameResize = function () {\n      log(\"Recalculating layout because _frame_ resized!\");\n      _this.measureFrameBounds();\n      _this.resolvePopoverLayout();\n    };\n\n    _this.getContainerNodeRef = function (containerEl) {\n      Object.assign(_this, { containerEl: containerEl });\n    };\n\n    _this.state = {\n      standing: \"above\",\n      exited: !_this.props.isOpen, // for animation-dependent rendering, should popover close/open?\n      exiting: false, // for tracking in-progress animations\n      toggle: _this.props.isOpen || false // for business logic tracking, should popover close/open?\n    };\n    return _this;\n  }\n\n  _createClass(Popover, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      /* Our component needs a DOM Node reference to the child so that it can be\n      measured so that we can correctly layout the popover. We do not have any\n      control over the child so cannot leverage refs. We could wrap our own\n      primitive component around the child but that could lead to breaking the\n      uses layout (e.g. the child is a flex item). Leveraging findDOMNode seems\n      to be the only functional solution, despite all the general warnings not to\n      use it. We have a legitimate use-case. */\n      // eslint-disable-next-line\n      this.targetEl = _reactDom2.default.findDOMNode(this);\n      if (this.props.isOpen) this.enter();\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(propsNext) {\n      //log(`Component received props!`, propsNext)\n      var willOpen = !this.props.isOpen && propsNext.isOpen;\n      var willClose = this.props.isOpen && !propsNext.isOpen;\n\n      if (willOpen) this.open();else if (willClose) this.close();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(propsPrev, statePrev) {\n      //log(`Component did update!`)\n      var didOpen = !statePrev.toggle && this.state.toggle;\n      var didClose = statePrev.toggle && !this.state.toggle;\n\n      if (didOpen) this.enter();else if (didClose) this.exit();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      /* If the Popover is unmounted while animating,\n      clear the animation so no setState occured */\n      this.animateExitStop();\n      /* If the Popover was never opened then then tracking\n      initialization never took place and so calling untrack\n      would be an error. Also see issue 55. */\n      if (this.hasTracked) this.untrackPopover();\n    }\n  }, {\n    key: \"resolvePopoverLayout\",\n    value: function resolvePopoverLayout() {\n      /* Find the optimal zone to position self. Measure the size of each zone and use the one with\n      the greatest area. */\n\n      var pickerSettings = {\n        preferPlace: this.props.preferPlace,\n        place: this.props.place\n\n        /* This is a kludge that solves a general problem very specifically for Popover.\n        The problem is subtle. When Popover positioning changes such that it resolves at\n        a different orientation, its Size will change because the Tip will toggle between\n        extending Height or Width. The general problem of course is that calculating\n        zone positioning based on current size is non-trivial if the Size can change once\n        resolved to a different zone. Infinite recursion can be triggered as we noted here:\n        https://github.com/littlebits/react-popover/issues/18. As an example of how this\n        could happen in another way: Imagine the user changes the CSS styling of the popover\n        based on whether it was `row` or `column` flow. TODO: Find a solution to generally\n        solve this problem so that the user is free to change the Popover styles in any\n        way at any time for any arbitrary trigger. There may be value in investigating the\n        http://overconstrained.io community for its general layout system via the\n        constraint-solver Cassowary. */\n      };if (this.zone) this.size[this.zone.flow === \"row\" ? \"h\" : \"w\"] += this.props.tipSize;\n      var zone = _layout2.default.pickZone(pickerSettings, this.frameBounds, this.targetBounds, this.size);\n      if (this.zone) this.size[this.zone.flow === \"row\" ? \"h\" : \"w\"] -= this.props.tipSize;\n\n      var tb = this.targetBounds;\n      this.zone = zone;\n      log(\"zone\", zone);\n\n      this.setState({\n        standing: zone.standing\n      });\n\n      var axis = _layout2.default.axes[zone.flow];\n      log(\"axes\", axis);\n\n      var dockingEdgeBufferLength = Math.round(getComputedStyle(this.bodyEl).borderRadius.slice(0, -2)) || 0;\n      var scrollSize = _layout2.default.El.calcScrollSize(this.frameEl);\n      scrollSize.main = scrollSize[axis.main.size];\n      scrollSize.cross = scrollSize[axis.cross.size];\n\n      /* When positioning self on the cross-axis do not exceed frame bounds. The strategy to achieve\n      this is thus: First position cross-axis self to the cross-axis-center of the the target. Then,\n      offset self by the amount that self is past the boundaries of frame. */\n      var pos = _layout2.default.calcRelPos(zone, tb, this.size);\n\n      /* Offset allows users to control the distance betweent the tip and the target. */\n      pos[axis.main.start] += this.props.offset * zone.order;\n\n      /* Constrain containerEl Position within frameEl. Try not to penetrate a visually-pleasing buffer from\n      frameEl. `frameBuffer` length is based on tipSize and its offset. */\n\n      var frameBuffer = this.props.tipSize + this.props.offset;\n      var hangingBufferLength = dockingEdgeBufferLength * 2 + this.props.tipSize * 2 + frameBuffer;\n      var frameCrossStart = this.frameBounds[axis.cross.start];\n      var frameCrossEnd = this.frameBounds[axis.cross.end];\n      var frameCrossLength = this.frameBounds[axis.cross.size];\n      var frameCrossInnerLength = frameCrossLength - frameBuffer * 2;\n      var frameCrossInnerStart = frameCrossStart + frameBuffer;\n      var frameCrossInnerEnd = frameCrossEnd - frameBuffer;\n      var popoverCrossStart = pos[axis.cross.start];\n      var popoverCrossEnd = pos[axis.cross.end];\n\n      /* If the popover dose not fit into frameCrossLength then just position it to the `frameCrossStart`.\n      popoverCrossLength` will now be forced to overflow into the `Frame` */\n      if (pos.crossLength > frameCrossLength) {\n        log(\"popoverCrossLength does not fit frame.\");\n        pos[axis.cross.start] = 0;\n\n        /* If the `popoverCrossStart` is forced beyond some threshold of `targetCrossLength` then bound\n        it (`popoverCrossStart`). */\n      } else if (tb[axis.cross.end] < hangingBufferLength) {\n        log(\"popoverCrossStart cannot hang any further without losing target.\");\n        pos[axis.cross.start] = tb[axis.cross.end] - hangingBufferLength;\n\n        /* checking if the cross start of the target area is within the frame and it makes sense\n        to try fitting popover into the frame. */\n      } else if (tb[axis.cross.start] > frameCrossInnerEnd) {\n        log(\"popoverCrossStart cannot hang any further without losing target.\");\n        pos[axis.cross.start] = tb[axis.cross.start] - this.size[axis.cross.size];\n\n        /* If the `popoverCrossStart` does not fit within the inner frame (honouring buffers) then\n        just center the popover in the remaining `frameCrossLength`. */\n      } else if (pos.crossLength > frameCrossInnerLength) {\n        log(\"popoverCrossLength does not fit within buffered frame.\");\n        pos[axis.cross.start] = (frameCrossLength - pos.crossLength) / 2;\n      } else if (popoverCrossStart < frameCrossInnerStart) {\n        log(\"popoverCrossStart cannot reverse without exceeding frame.\");\n        pos[axis.cross.start] = frameCrossInnerStart;\n      } else if (popoverCrossEnd > frameCrossInnerEnd) {\n        log(\"popoverCrossEnd cannot travel without exceeding frame.\");\n        pos[axis.cross.start] = pos[axis.cross.start] - (pos[axis.cross.end] - frameCrossInnerEnd);\n      }\n\n      /* So far the link position has been calculated relative to the target. To calculate the absolute\n      position we need to factor the `Frame``s scroll position */\n\n      pos[axis.cross.start] += scrollSize.cross;\n      pos[axis.main.start] += scrollSize.main;\n\n      /* Apply `flow` and `order` styles. This can impact subsequent measurements of height and width\n      of the container. When tip changes orientation position due to changes from/to `row`/`column`\n      width`/`height` will be impacted. Our layout monitoring will catch these cases and automatically\n      recalculate layout. */\n      if (this.containerEl) {\n        this.containerEl.style.flexFlow = zone.flow;\n        this.containerEl.style[jsprefix(\"FlexFlow\")] = this.containerEl.style.flexFlow;\n      }\n      this.bodyEl.style.order = zone.order;\n      this.bodyEl.style[jsprefix(\"Order\")] = this.bodyEl.style.order;\n\n      /* Apply Absolute Positioning. */\n\n      log(\"pos\", pos);\n      if (this.containerEl) {\n        this.containerEl.style.top = pos.y + \"px\";\n        this.containerEl.style.left = pos.x + \"px\";\n      }\n\n      /* Calculate Tip Position */\n\n      var tipCrossPos =\n      /* Get the absolute tipCrossCenter. Tip is positioned relative to containerEl\n      but it aims at targetCenter which is positioned relative to frameEl... we\n      need to cancel the containerEl positioning so as to hit our intended position. */\n      _layout2.default.centerOfBoundsFromBounds(zone.flow, \"cross\", tb, pos) +\n      /* centerOfBounds does not account for scroll so we need to manually add that\n      here. */\n      scrollSize.cross -\n      /* Center tip relative to self. We do not have to calcualte half-of-tip-size since tip-size\n      specifies the length from base to tip which is half of total length already. */\n      this.props.tipSize;\n\n      if (tipCrossPos < dockingEdgeBufferLength) tipCrossPos = dockingEdgeBufferLength;else if (tipCrossPos > pos.crossLength - dockingEdgeBufferLength - this.props.tipSize * 2) {\n        tipCrossPos = pos.crossLength - dockingEdgeBufferLength - this.props.tipSize * 2;\n      }\n\n      this.tipEl.style.transform = flowToTipTranslations[zone.flow] + \"(\" + tipCrossPos + \"px)\";\n      this.tipEl.style[jsprefix(\"Transform\")] = this.tipEl.style.transform;\n    }\n  }, {\n    key: \"measurePopoverSize\",\n    value: function measurePopoverSize() {\n      this.size = _layout2.default.El.calcSize(this.containerEl);\n    }\n  }, {\n    key: \"measureTargetBounds\",\n    value: function measureTargetBounds() {\n      var newTargetBounds = _layout2.default.El.calcBounds(this.targetEl);\n\n      if (this.targetBounds && _layout2.default.equalCoords(this.targetBounds, newTargetBounds)) {\n        return false;\n      }\n\n      this.targetBounds = newTargetBounds;\n      return true;\n    }\n  }, {\n    key: \"open\",\n    value: function open() {\n      if (this.state.exiting) this.animateExitStop();\n      this.setState({ toggle: true, exited: false });\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.setState({ toggle: false });\n    }\n  }, {\n    key: \"enter\",\n    value: function enter() {\n      if (_platform2.default.isServer) return;\n      log(\"enter!\");\n      this.trackPopover();\n      this.animateEnter();\n    }\n  }, {\n    key: \"exit\",\n    value: function exit() {\n      log(\"exit!\");\n      this.animateExit();\n      this.untrackPopover();\n    }\n  }, {\n    key: \"animateExitStop\",\n    value: function animateExitStop() {\n      clearTimeout(this.exitingAnimationTimer1);\n      clearTimeout(this.exitingAnimationTimer2);\n      this.setState({ exiting: false });\n    }\n  }, {\n    key: \"animateExit\",\n    value: function animateExit() {\n      var _this2 = this;\n\n      this.setState({ exiting: true });\n      this.exitingAnimationTimer2 = setTimeout(function () {\n        setTimeout(function () {\n          if (_this2.containerEl) {\n            _this2.containerEl.style.transform = flowToPopoverTranslations[_this2.zone.flow] + \"(\" + _this2.zone.order * 50 + \"px)\";\n            _this2.containerEl.style.opacity = \"0\";\n          }\n        }, 0);\n      }, 0);\n\n      this.exitingAnimationTimer1 = setTimeout(function () {\n        _this2.setState({ exited: true, exiting: false });\n      }, this.props.enterExitTransitionDurationMs);\n    }\n  }, {\n    key: \"animateEnter\",\n    value: function animateEnter() {\n      /* Prepare `entering` style so that we can then animate it toward `entered`. */\n\n      this.containerEl.style.transform = flowToPopoverTranslations[this.zone.flow] + \"(\" + this.zone.order * 50 + \"px)\";\n      this.containerEl.style[jsprefix(\"Transform\")] = this.containerEl.style.transform;\n      this.containerEl.style.opacity = \"0\";\n\n      /* After initial layout apply transition animations. */\n      /* Hack: http://stackoverflow.com/questions/3485365/how-can-i-force-webkit-to-redraw-repaint-to-propagate-style-changes */\n      this.containerEl.offsetHeight;\n\n      /* If enterExitTransitionDurationMs is falsy, tip animation should be also disabled */\n      if (this.props.enterExitTransitionDurationMs) {\n        this.tipEl.style.transition = \"transform 150ms ease-in\";\n        this.tipEl.style[jsprefix(\"Transition\")] = cssprefix(\"transform\") + \" 150ms ease-in\";\n      }\n      this.containerEl.style.transitionProperty = \"top, left, opacity, transform\";\n      this.containerEl.style.transitionDuration = this.props.enterExitTransitionDurationMs + \"ms\";\n      this.containerEl.style.transitionTimingFunction = \"cubic-bezier(0.230, 1.000, 0.320, 1.000)\";\n      this.containerEl.style.opacity = \"1\";\n      this.containerEl.style.transform = \"translateY(0)\";\n      this.containerEl.style[jsprefix(\"Transform\")] = this.containerEl.style.transform;\n    }\n  }, {\n    key: \"trackPopover\",\n    value: function trackPopover() {\n      var minScrollRefreshIntervalMs = 200;\n      var minResizeRefreshIntervalMs = 200;\n\n      /* Get references to DOM elements. */\n\n      this.bodyEl = this.containerEl.querySelector(\".Popover-body\");\n      this.tipEl = this.containerEl.querySelector(\".Popover-tip\");\n\n      /* Note: frame is hardcoded to window now but we think it will\n      be a nice feature in the future to allow other frames to be used\n      such as local elements that further constrain the popover`s world. */\n\n      this.frameEl = _platform2.default.window;\n      this.hasTracked = true;\n\n      /* Set a general interval for checking if target position changed. There is no way\n      to know this information without polling. */\n      if (this.props.refreshIntervalMs) {\n        this.checkLayoutInterval = setInterval(this.checkTargetReposition, this.props.refreshIntervalMs);\n      }\n\n      /* Watch for boundary changes in all deps, and when one of them changes, recalculate layout.\n      This layout monitoring must be bound immediately because a layout recalculation can recursively\n      cause a change in boundaries. So if we did a one-time force-layout before watching boundaries\n      our final position calculations could be wrong. See comments in resolver function for details\n      about which parts can trigger recursive recalculation. */\n\n      this.onFrameScroll = (0, _lodash2.default)(this.onFrameScroll, minScrollRefreshIntervalMs);\n      this.onFrameResize = (0, _lodash2.default)(this.onFrameResize, minResizeRefreshIntervalMs);\n      this.onPopoverResize = (0, _lodash2.default)(this.onPopoverResize, minResizeRefreshIntervalMs);\n      this.onTargetResize = (0, _lodash2.default)(this.onTargetResize, minResizeRefreshIntervalMs);\n\n      this.frameEl.addEventListener(\"scroll\", this.onFrameScroll);\n      _onResize2.default.on(this.frameEl, this.onFrameResize);\n      _onResize2.default.on(this.containerEl, this.onPopoverResize);\n      _onResize2.default.on(this.targetEl, this.onTargetResize);\n\n      /* Track user actions on the page. Anything that occurs _outside_ the Popover boundaries\n      should close the Popover. */\n\n      _platform2.default.document.addEventListener(\"mousedown\", this.checkForOuterAction);\n      _platform2.default.document.addEventListener(\"touchstart\", this.checkForOuterAction);\n\n      /* Kickstart layout at first boot. */\n\n      this.measurePopoverSize();\n      this.measureFrameBounds();\n      this.measureTargetBounds();\n      this.resolvePopoverLayout();\n    }\n  }, {\n    key: \"untrackPopover\",\n    value: function untrackPopover() {\n      clearInterval(this.checkLayoutInterval);\n      this.frameEl.removeEventListener(\"scroll\", this.onFrameScroll);\n      _onResize2.default.off(this.frameEl, this.onFrameResize);\n      _onResize2.default.off(this.containerEl, this.onPopoverResize);\n      _onResize2.default.off(this.targetEl, this.onTargetResize);\n      _platform2.default.document.removeEventListener(\"mousedown\", this.checkForOuterAction);\n      _platform2.default.document.removeEventListener(\"touchstart\", this.checkForOuterAction);\n      this.hasTracked = false;\n    }\n  }, {\n    key: \"measureFrameBounds\",\n    value: function measureFrameBounds() {\n      this.frameBounds = _layout2.default.El.calcBounds(this.frameEl);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _props = this.props,\n          _props$className = _props.className,\n          className = _props$className === undefined ? \"\" : _props$className,\n          _props$style = _props.style,\n          style = _props$style === undefined ? {} : _props$style,\n          tipSize = _props.tipSize;\n      var standing = this.state.standing;\n\n\n      var popoverProps = {\n        className: \"Popover Popover-\" + standing + \" \" + className,\n        style: _extends({}, coreStyle, style)\n      };\n\n      var popover = this.state.exited ? null : _react2.default.createElement(\n        \"div\",\n        _extends({ ref: this.getContainerNodeRef }, popoverProps),\n        _react2.default.createElement(\"div\", { className: \"Popover-body\", children: this.props.body }),\n        _react2.default.createElement(_tip2.default, { direction: faces[standing], size: tipSize })\n      );\n      return [this.props.children, _platform2.default.isClient && _reactDom2.default.createPortal(popover, this.props.appendTarget)];\n    }\n  }]);\n\n  return Popover;\n}(_react2.default.Component);\n\nPopover.propTypes = {\n  body: _propTypes2.default.node.isRequired,\n  children: _propTypes2.default.element.isRequired,\n  appendTarget: _propTypes2.default.object,\n  className: _propTypes2.default.string,\n  enterExitTransitionDurationMs: _propTypes2.default.number,\n  isOpen: _propTypes2.default.bool,\n  offset: _propTypes2.default.number,\n  place: _propTypes2.default.oneOf(_layout2.default.validTypeValues),\n  preferPlace: _propTypes2.default.oneOf(_layout2.default.validTypeValues),\n  refreshIntervalMs: _propTypes2.default.oneOfType([_propTypes2.default.number, _propTypes2.default.bool]),\n  style: _propTypes2.default.object,\n  tipSize: _propTypes2.default.number,\n  onOuterAction: _propTypes2.default.func\n};\nPopover.defaultProps = {\n  tipSize: 7,\n  preferPlace: null,\n  place: null,\n  offset: 4,\n  isOpen: false,\n  onOuterAction: _utils2.default.noop,\n  enterExitTransitionDurationMs: 500,\n  children: null,\n  refreshIntervalMs: 200,\n  appendTarget: _platform2.default.isClient ? _platform2.default.document.body : null\n};\nexports.default = Popover;"]},"metadata":{},"sourceType":"script"}