{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar react_1 = __importDefault(require(\"react\"));\n\nvar ArrowContainer_1 = require(\"./ArrowContainer\");\n\nexports.ArrowContainer = ArrowContainer_1.ArrowContainer;\n\nvar PopoverPortal_1 = require(\"./PopoverPortal\");\n\nvar util_1 = require(\"./util\");\n\nvar DEFAULT_POSITION_ORDER = ['top', 'right', 'left', 'bottom'];\n\nvar Popover =\n/** @class */\nfunction (_super) {\n  __extends(Popover, _super);\n\n  function Popover(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.targetRef = react_1.default.createRef();\n    _this.targetRect = undefined;\n    _this.targetPositionIntervalHandler = undefined;\n    _this.popoverDiv = undefined;\n    _this.positionOrder = undefined;\n    _this.willUnmount = false;\n    _this.willMount = false;\n\n    _this.onClick = function (e) {\n      var _a = _this.props,\n          onClickOutside = _a.onClickOutside,\n          isOpen = _a.isOpen;\n\n      if (!_this.willUnmount && !_this.willMount && !_this.popoverDiv.contains(e.target) && !_this.targetRef.current.contains(e.target) && onClickOutside && isOpen) {\n        onClickOutside(e);\n      }\n    };\n\n    _this.onResize = function () {\n      _this.renderPopover();\n    };\n\n    _this.state = {\n      popoverInfo: undefined,\n      isTransitioningToClosed: false,\n      internalisOpen: false\n    };\n    _this.willUnmount = false;\n    _this.willMount = true;\n    return _this;\n  }\n\n  Popover.getDerivedStateFromProps = function (props, state) {\n    var internalisOpen = state.internalisOpen,\n        isTransitioningToClosed = state.isTransitioningToClosed;\n    var isOpen = props.isOpen;\n\n    if (internalisOpen === true && isOpen === false && !isTransitioningToClosed) {\n      return {\n        internalisOpen: false,\n        isTransitioningToClosed: true\n      };\n    } // eslint-disable-next-line no-restricted-syntax\n\n\n    return null;\n  };\n\n  Popover.prototype.componentDidMount = function () {\n    var _this = this;\n\n    window.setTimeout(function () {\n      return _this.willMount = false;\n    });\n    var _a = this.props,\n        position = _a.position,\n        isOpen = _a.isOpen;\n    this.positionOrder = this.getPositionPriorityOrder(position);\n    this.updatePopover(isOpen);\n  };\n\n  Popover.prototype.componentDidUpdate = function (prevProps) {\n    var prevIsOpen = prevProps.isOpen,\n        prevAlign = prevProps.align,\n        prevPosition = prevProps.position,\n        prevTransitionDuration = prevProps.transitionDuration,\n        prevPadding = prevProps.padding,\n        prevWindowBorderPadding = prevProps.windowBorderPadding;\n    var _a = this.props,\n        isOpen = _a.isOpen,\n        position = _a.position,\n        transitionDuration = _a.transitionDuration,\n        align = _a.align,\n        contentDestination = _a.contentDestination,\n        padding = _a.padding,\n        windowBorderPadding = _a.windowBorderPadding;\n    this.positionOrder = this.getPositionPriorityOrder(position);\n    var hasNewDestination = prevProps.contentDestination !== contentDestination;\n\n    if (prevIsOpen !== isOpen || prevAlign !== align || prevPosition !== position || prevPadding !== padding || prevWindowBorderPadding !== windowBorderPadding || hasNewDestination) {\n      this.updatePopover(isOpen);\n    }\n\n    if (prevTransitionDuration !== transitionDuration) {\n      this.popoverDiv.style.transition = \"opacity \" + transitionDuration + \"s\";\n    }\n  };\n\n  Popover.prototype.componentWillUnmount = function () {\n    this.willUnmount = true;\n    window.clearTimeout(this.removePopoverTimeout);\n    window.clearInterval(this.targetPositionIntervalHandler);\n    window.removeEventListener('resize', this.onResize);\n    window.removeEventListener('click', this.onClick);\n    this.removePopover();\n  };\n\n  Popover.prototype.getNudgedPopoverPosition = function (_a) {\n    var top = _a.top,\n        left = _a.left,\n        width = _a.width,\n        height = _a.height;\n    var padding = this.props.windowBorderPadding;\n    top = top < padding ? padding : top;\n    top = top + height > window.innerHeight - padding ? window.innerHeight - padding - height : top;\n    left = left < padding ? padding : left;\n    left = left + width > window.innerWidth - padding ? window.innerWidth - padding - width : left;\n    return {\n      top: top,\n      left: left\n    };\n  };\n\n  Popover.prototype.getPositionPriorityOrder = function (position) {\n    if (position && typeof position !== 'string') {\n      if (util_1.Constants.DEFAULT_POSITIONS.every(function (defaultPosition) {\n        return position.find(function (p) {\n          return p === defaultPosition;\n        }) !== undefined;\n      })) {\n        return util_1.arrayUnique(position);\n      }\n\n      var remainingPositions = util_1.Constants.DEFAULT_POSITIONS.filter(function (defaultPosition) {\n        return position.find(function (p) {\n          return p === defaultPosition;\n        }) === undefined;\n      });\n      return util_1.arrayUnique(__spreadArrays(position, remainingPositions));\n    }\n\n    if (position && typeof position === 'string') {\n      var remainingPositions = util_1.Constants.DEFAULT_POSITIONS.filter(function (defaultPosition) {\n        return defaultPosition !== position;\n      });\n      return util_1.arrayUnique(__spreadArrays([position], remainingPositions));\n    }\n\n    return DEFAULT_POSITION_ORDER;\n  };\n\n  Popover.prototype.getLocationForPosition = function (position, newTargetRect, popoverRect) {\n    var _a = this.props,\n        padding = _a.padding,\n        align = _a.align;\n    var targetMidX = newTargetRect.left + newTargetRect.width / 2;\n    var targetMidY = newTargetRect.top + newTargetRect.height / 2;\n    var top;\n    var left;\n\n    switch (position) {\n      case 'top':\n        top = newTargetRect.top - popoverRect.height - padding;\n        left = targetMidX - popoverRect.width / 2;\n\n        if (align === 'start') {\n          left = newTargetRect.left;\n        }\n\n        if (align === 'end') {\n          left = newTargetRect.right - popoverRect.width;\n        }\n\n        break;\n\n      case 'left':\n        top = targetMidY - popoverRect.height / 2;\n        left = newTargetRect.left - padding - popoverRect.width;\n\n        if (align === 'start') {\n          top = newTargetRect.top;\n        }\n\n        if (align === 'end') {\n          top = newTargetRect.bottom - popoverRect.height;\n        }\n\n        break;\n\n      case 'bottom':\n        top = newTargetRect.bottom + padding;\n        left = targetMidX - popoverRect.width / 2;\n\n        if (align === 'start') {\n          left = newTargetRect.left;\n        }\n\n        if (align === 'end') {\n          left = newTargetRect.right - popoverRect.width;\n        }\n\n        break;\n\n      case 'right':\n        top = targetMidY - popoverRect.height / 2;\n        left = newTargetRect.right + padding;\n\n        if (align === 'start') {\n          top = newTargetRect.top;\n        }\n\n        if (align === 'end') {\n          top = newTargetRect.bottom - popoverRect.height;\n        }\n\n        break;\n\n      default:\n        break;\n    }\n\n    return {\n      top: top,\n      left: left\n    };\n  };\n\n  Popover.prototype.createContainer = function () {\n    var _a = this.props,\n        containerStyle = _a.containerStyle,\n        containerClassName = _a.containerClassName;\n    var container = window.document.createElement('div');\n    container.style.overflow = 'hidden';\n\n    if (containerStyle) {\n      Object.keys(containerStyle).forEach(function (key) {\n        return container.style[key] = containerStyle[key];\n      });\n    }\n\n    container.className = containerClassName;\n    container.style.position = 'absolute';\n    container.style.top = '0';\n    container.style.left = '0';\n    return container;\n  };\n\n  Popover.prototype.updatePopover = function (isOpen) {\n    if (isOpen && this.targetRef) {\n      if (!this.popoverDiv || !this.popoverDiv.parentNode) {\n        var transitionDuration = this.props.transitionDuration;\n        this.popoverDiv = this.createContainer();\n        this.popoverDiv.style.opacity = '0';\n        this.popoverDiv.style.transition = \"opacity \" + transitionDuration + \"s\";\n      }\n\n      window.addEventListener('resize', this.onResize);\n      window.addEventListener('click', this.onClick);\n      this.renderPopover();\n    } else {\n      this.removePopover();\n    }\n  };\n\n  Popover.prototype.startTargetPositionListener = function (checkInterval) {\n    var _this = this;\n\n    if (!this.targetPositionIntervalHandler) {\n      this.targetPositionIntervalHandler = window.setInterval(function () {\n        var newTargetRect = _this.targetRef.current.getBoundingClientRect();\n\n        if (util_1.targetPositionHasChanged(_this.targetRect, newTargetRect)) {\n          _this.renderPopover();\n        }\n\n        _this.targetRect = newTargetRect;\n      }, checkInterval);\n    }\n  };\n\n  Popover.prototype.removePopover = function () {\n    var _this = this; // this should now be a callback to handle event listening upon portal disappearance\n\n\n    var _a = this.props,\n        transitionDuration = _a.transitionDuration,\n        isOpen = _a.isOpen;\n\n    if (this.popoverDiv) {\n      this.popoverDiv.style.opacity = '0';\n    }\n\n    var remove = function () {\n      if (_this.willUnmount || !isOpen || !_this.popoverDiv.parentNode) {\n        window.clearInterval(_this.targetPositionIntervalHandler);\n        window.removeEventListener('resize', _this.onResize);\n        window.removeEventListener('click', _this.onClick);\n        _this.targetPositionIntervalHandler = undefined;\n\n        _this.setState({\n          isTransitioningToClosed: false\n        });\n      }\n    };\n\n    if (!this.willUnmount) {\n      this.removePopoverTimeout = window.setTimeout(remove, (transitionDuration || util_1.Constants.FADE_TRANSITION) * 1000);\n    } else {\n      remove();\n    }\n  };\n\n  Popover.prototype.renderPopover = function (positionIndex) {\n    var _this = this;\n\n    if (positionIndex === void 0) {\n      positionIndex = 0;\n    }\n\n    if (positionIndex >= this.positionOrder.length) {\n      return;\n    }\n\n    this.renderWithPosition({\n      position: this.positionOrder[positionIndex],\n      targetRect: this.targetRef.current.getBoundingClientRect()\n    }, function (violation, rect) {\n      var _a;\n\n      var _b = _this.props,\n          disableReposition = _b.disableReposition,\n          contentLocation = _b.contentLocation,\n          contentDestination = _b.contentDestination;\n\n      if (violation && !disableReposition && !(typeof contentLocation === 'object')) {\n        _this.renderPopover(positionIndex + 1);\n      } else {\n        var _c = _this.props,\n            contentLocation_1 = _c.contentLocation,\n            align = _c.align;\n\n        var _d = _this.getNudgedPopoverPosition(rect),\n            nudgedTop = _d.top,\n            nudgedLeft = _d.left;\n\n        var rectTop = rect.top,\n            rectLeft = rect.left;\n        var position = _this.positionOrder[positionIndex];\n\n        var _e = disableReposition ? {\n          top: rectTop,\n          left: rectLeft\n        } : {\n          top: nudgedTop,\n          left: nudgedLeft\n        },\n            top_1 = _e.top,\n            left = _e.left;\n\n        if (contentLocation_1) {\n          var targetRect = _this.targetRef.current.getBoundingClientRect();\n\n          var popoverRect = _this.popoverDiv.getBoundingClientRect();\n\n          _a = typeof contentLocation_1 === 'function' ? contentLocation_1({\n            targetRect: targetRect,\n            popoverRect: popoverRect,\n            position: position,\n            align: align,\n            nudgedLeft: nudgedLeft,\n            nudgedTop: nudgedTop\n          }) : contentLocation_1, top_1 = _a.top, left = _a.left;\n          _this.popoverDiv.style.left = left.toFixed() + \"px\";\n          _this.popoverDiv.style.top = top_1.toFixed() + \"px\";\n        } else {\n          var destinationTopOffset = 0;\n          var destinationLeftOffset = 0;\n\n          if (contentDestination) {\n            var destRect = contentDestination.getBoundingClientRect();\n            destinationTopOffset = -destRect.top;\n            destinationLeftOffset = -destRect.left;\n          }\n\n          var absoluteTop = top_1 + window.pageYOffset;\n          var absoluteLeft = left + window.pageXOffset;\n          var finalLeft = absoluteLeft + destinationTopOffset;\n          var finalTop = absoluteTop + destinationLeftOffset;\n          _this.popoverDiv.style.left = finalLeft.toFixed() + \"px\";\n          _this.popoverDiv.style.top = finalTop.toFixed() + \"px\";\n        }\n\n        _this.popoverDiv.style.width = undefined;\n        _this.popoverDiv.style.height = undefined;\n\n        _this.renderWithPosition({\n          position: position,\n          nudgedTop: nudgedTop - rect.top,\n          nudgedLeft: nudgedLeft - rect.left,\n          targetRect: _this.targetRef.current.getBoundingClientRect(),\n          popoverRect: _this.popoverDiv.getBoundingClientRect()\n        }, function () {\n          _this.startTargetPositionListener(10);\n\n          if (_this.popoverDiv.style.opacity !== '1' && !_this.state.isTransitioningToClosed) {\n            _this.popoverDiv.style.opacity = '1';\n          }\n        });\n      }\n    });\n  };\n\n  Popover.prototype.renderPopoverContent = function () {\n    var _a = this.props,\n        content = _a.content,\n        isOpen = _a.isOpen,\n        contentDestination = _a.contentDestination;\n    var _b = this.state,\n        popoverInfo = _b.popoverInfo,\n        isTransitioningToClosed = _b.isTransitioningToClosed;\n\n    if ((isOpen || isTransitioningToClosed) && this.popoverDiv && popoverInfo) {\n      var getContent = function (args) {\n        return typeof content === 'function' ? content(args) : content;\n      };\n\n      return react_1.default.createElement(PopoverPortal_1.PopoverPortal, {\n        element: this.popoverDiv,\n        container: contentDestination || window.document.body\n      }, getContent(popoverInfo));\n    }\n\n    return null;\n  };\n\n  Popover.prototype.renderChildContent = function () {\n    var children = this.props.children;\n    return typeof children === 'function' ? children(this.targetRef) : react_1.default.cloneElement(children, {\n      ref: this.targetRef\n    });\n  };\n\n  Popover.prototype.renderWithPosition = function (_a, callback) {\n    var _this = this;\n\n    var position = _a.position,\n        _b = _a.nudgedLeft,\n        nudgedLeft = _b === void 0 ? 0 : _b,\n        _c = _a.nudgedTop,\n        nudgedTop = _c === void 0 ? 0 : _c,\n        _d = _a.targetRect,\n        targetRect = _d === void 0 ? util_1.Constants.EMPTY_CLIENT_RECT : _d,\n        _e = _a.popoverRect,\n        popoverRect = _e === void 0 ? util_1.Constants.EMPTY_CLIENT_RECT : _e;\n    var _f = this.props,\n        padding = _f.windowBorderPadding,\n        align = _f.align;\n    var popoverInfo = {\n      position: position,\n      nudgedLeft: nudgedLeft,\n      nudgedTop: nudgedTop,\n      targetRect: targetRect,\n      popoverRect: popoverRect,\n      align: align\n    };\n\n    if (!util_1.popoverInfosAreEqual(this.state.popoverInfo, popoverInfo)) {\n      window.clearTimeout(this.removePopoverTimeout);\n      this.setState({\n        popoverInfo: popoverInfo,\n        isTransitioningToClosed: false,\n        internalisOpen: true\n      }, function () {\n        if (_this.willUnmount) {\n          return;\n        }\n\n        targetRect = _this.targetRef.current.getBoundingClientRect();\n        popoverRect = _this.popoverDiv.getBoundingClientRect();\n\n        var _a = _this.getLocationForPosition(position, targetRect, popoverRect),\n            top = _a.top,\n            left = _a.left;\n\n        callback(position === 'top' && top < padding || position === 'left' && left < padding || position === 'right' && left + popoverRect.width > window.innerWidth - padding || position === 'bottom' && top + popoverRect.height > window.innerHeight - padding, {\n          width: popoverRect.width,\n          height: popoverRect.height,\n          top: top,\n          left: left\n        });\n      });\n    }\n  };\n\n  Popover.prototype.render = function () {\n    return react_1.default.createElement(react_1.default.Fragment, null, this.renderChildContent(), this.renderPopoverContent());\n  };\n\n  Popover.defaultProps = {\n    padding: util_1.Constants.DEFAULT_PADDING,\n    windowBorderPadding: util_1.Constants.DEFAULT_WINDOW_PADDING,\n    position: DEFAULT_POSITION_ORDER,\n    align: 'center',\n    containerClassName: util_1.Constants.POPOVER_CONTAINER_CLASS_NAME,\n    transitionDuration: util_1.Constants.FADE_TRANSITION\n  };\n  return Popover;\n}(react_1.default.Component);\n\nexports.default = Popover;","map":{"version":3,"sources":["E:/project/front/tmd/node_modules/react-tiny-popover/dist/Popover.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__spreadArrays","s","i","il","arguments","length","r","k","a","j","jl","__importDefault","mod","__esModule","defineProperty","exports","value","react_1","require","ArrowContainer_1","ArrowContainer","PopoverPortal_1","util_1","DEFAULT_POSITION_ORDER","Popover","_super","props","_this","call","targetRef","default","createRef","targetRect","undefined","targetPositionIntervalHandler","popoverDiv","positionOrder","willUnmount","willMount","onClick","e","_a","onClickOutside","isOpen","contains","target","current","onResize","renderPopover","state","popoverInfo","isTransitioningToClosed","internalisOpen","getDerivedStateFromProps","componentDidMount","window","setTimeout","position","getPositionPriorityOrder","updatePopover","componentDidUpdate","prevProps","prevIsOpen","prevAlign","align","prevPosition","prevTransitionDuration","transitionDuration","prevPadding","padding","prevWindowBorderPadding","windowBorderPadding","contentDestination","hasNewDestination","style","transition","componentWillUnmount","clearTimeout","removePopoverTimeout","clearInterval","removeEventListener","removePopover","getNudgedPopoverPosition","top","left","width","height","innerHeight","innerWidth","Constants","DEFAULT_POSITIONS","every","defaultPosition","find","arrayUnique","remainingPositions","filter","getLocationForPosition","newTargetRect","popoverRect","targetMidX","targetMidY","right","bottom","createContainer","containerStyle","containerClassName","container","document","createElement","overflow","keys","forEach","key","className","parentNode","opacity","addEventListener","startTargetPositionListener","checkInterval","setInterval","getBoundingClientRect","targetPositionHasChanged","remove","setState","FADE_TRANSITION","positionIndex","renderWithPosition","violation","rect","_b","disableReposition","contentLocation","_c","contentLocation_1","_d","nudgedTop","nudgedLeft","rectTop","rectLeft","_e","top_1","toFixed","destinationTopOffset","destinationLeftOffset","destRect","absoluteTop","pageYOffset","absoluteLeft","pageXOffset","finalLeft","finalTop","renderPopoverContent","content","getContent","args","PopoverPortal","element","body","renderChildContent","children","cloneElement","ref","callback","EMPTY_CLIENT_RECT","_f","popoverInfosAreEqual","render","Fragment","defaultProps","DEFAULT_PADDING","DEFAULT_WINDOW_PADDING","POPOVER_CONTAINER_CLASS_NAME","Component"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar ArrowContainer_1 = require(\"./ArrowContainer\");\nexports.ArrowContainer = ArrowContainer_1.ArrowContainer;\nvar PopoverPortal_1 = require(\"./PopoverPortal\");\nvar util_1 = require(\"./util\");\nvar DEFAULT_POSITION_ORDER = ['top', 'right', 'left', 'bottom'];\nvar Popover = /** @class */ (function (_super) {\n    __extends(Popover, _super);\n    function Popover(props) {\n        var _this = _super.call(this, props) || this;\n        _this.targetRef = react_1.default.createRef();\n        _this.targetRect = undefined;\n        _this.targetPositionIntervalHandler = undefined;\n        _this.popoverDiv = undefined;\n        _this.positionOrder = undefined;\n        _this.willUnmount = false;\n        _this.willMount = false;\n        _this.onClick = function (e) {\n            var _a = _this.props, onClickOutside = _a.onClickOutside, isOpen = _a.isOpen;\n            if (!_this.willUnmount &&\n                !_this.willMount &&\n                !_this.popoverDiv.contains(e.target) &&\n                !_this.targetRef.current.contains(e.target) &&\n                onClickOutside &&\n                isOpen) {\n                onClickOutside(e);\n            }\n        };\n        _this.onResize = function () {\n            _this.renderPopover();\n        };\n        _this.state = {\n            popoverInfo: undefined,\n            isTransitioningToClosed: false,\n            internalisOpen: false,\n        };\n        _this.willUnmount = false;\n        _this.willMount = true;\n        return _this;\n    }\n    Popover.getDerivedStateFromProps = function (props, state) {\n        var internalisOpen = state.internalisOpen, isTransitioningToClosed = state.isTransitioningToClosed;\n        var isOpen = props.isOpen;\n        if (internalisOpen === true && isOpen === false && !isTransitioningToClosed) {\n            return {\n                internalisOpen: false,\n                isTransitioningToClosed: true,\n            };\n        }\n        // eslint-disable-next-line no-restricted-syntax\n        return null;\n    };\n    Popover.prototype.componentDidMount = function () {\n        var _this = this;\n        window.setTimeout(function () { return (_this.willMount = false); });\n        var _a = this.props, position = _a.position, isOpen = _a.isOpen;\n        this.positionOrder = this.getPositionPriorityOrder(position);\n        this.updatePopover(isOpen);\n    };\n    Popover.prototype.componentDidUpdate = function (prevProps) {\n        var prevIsOpen = prevProps.isOpen, prevAlign = prevProps.align, prevPosition = prevProps.position, prevTransitionDuration = prevProps.transitionDuration, prevPadding = prevProps.padding, prevWindowBorderPadding = prevProps.windowBorderPadding;\n        var _a = this.props, isOpen = _a.isOpen, position = _a.position, transitionDuration = _a.transitionDuration, align = _a.align, contentDestination = _a.contentDestination, padding = _a.padding, windowBorderPadding = _a.windowBorderPadding;\n        this.positionOrder = this.getPositionPriorityOrder(position);\n        var hasNewDestination = prevProps.contentDestination !== contentDestination;\n        if (prevIsOpen !== isOpen ||\n            prevAlign !== align ||\n            prevPosition !== position ||\n            prevPadding !== padding ||\n            prevWindowBorderPadding !== windowBorderPadding ||\n            hasNewDestination) {\n            this.updatePopover(isOpen);\n        }\n        if (prevTransitionDuration !== transitionDuration) {\n            this.popoverDiv.style.transition = \"opacity \" + transitionDuration + \"s\";\n        }\n    };\n    Popover.prototype.componentWillUnmount = function () {\n        this.willUnmount = true;\n        window.clearTimeout(this.removePopoverTimeout);\n        window.clearInterval(this.targetPositionIntervalHandler);\n        window.removeEventListener('resize', this.onResize);\n        window.removeEventListener('click', this.onClick);\n        this.removePopover();\n    };\n    Popover.prototype.getNudgedPopoverPosition = function (_a) {\n        var top = _a.top, left = _a.left, width = _a.width, height = _a.height;\n        var padding = this.props.windowBorderPadding;\n        top = top < padding ? padding : top;\n        top = top + height > window.innerHeight - padding ? window.innerHeight - padding - height : top;\n        left = left < padding ? padding : left;\n        left = left + width > window.innerWidth - padding ? window.innerWidth - padding - width : left;\n        return { top: top, left: left };\n    };\n    Popover.prototype.getPositionPriorityOrder = function (position) {\n        if (position && typeof position !== 'string') {\n            if (util_1.Constants.DEFAULT_POSITIONS.every(function (defaultPosition) { return position.find(function (p) { return p === defaultPosition; }) !== undefined; })) {\n                return util_1.arrayUnique(position);\n            }\n            var remainingPositions = util_1.Constants.DEFAULT_POSITIONS.filter(function (defaultPosition) { return position.find(function (p) { return p === defaultPosition; }) === undefined; });\n            return util_1.arrayUnique(__spreadArrays(position, remainingPositions));\n        }\n        if (position && typeof position === 'string') {\n            var remainingPositions = util_1.Constants.DEFAULT_POSITIONS.filter(function (defaultPosition) { return defaultPosition !== position; });\n            return util_1.arrayUnique(__spreadArrays([position], remainingPositions));\n        }\n        return DEFAULT_POSITION_ORDER;\n    };\n    Popover.prototype.getLocationForPosition = function (position, newTargetRect, popoverRect) {\n        var _a = this.props, padding = _a.padding, align = _a.align;\n        var targetMidX = newTargetRect.left + newTargetRect.width / 2;\n        var targetMidY = newTargetRect.top + newTargetRect.height / 2;\n        var top;\n        var left;\n        switch (position) {\n            case 'top':\n                top = newTargetRect.top - popoverRect.height - padding;\n                left = targetMidX - popoverRect.width / 2;\n                if (align === 'start') {\n                    left = newTargetRect.left;\n                }\n                if (align === 'end') {\n                    left = newTargetRect.right - popoverRect.width;\n                }\n                break;\n            case 'left':\n                top = targetMidY - popoverRect.height / 2;\n                left = newTargetRect.left - padding - popoverRect.width;\n                if (align === 'start') {\n                    top = newTargetRect.top;\n                }\n                if (align === 'end') {\n                    top = newTargetRect.bottom - popoverRect.height;\n                }\n                break;\n            case 'bottom':\n                top = newTargetRect.bottom + padding;\n                left = targetMidX - popoverRect.width / 2;\n                if (align === 'start') {\n                    left = newTargetRect.left;\n                }\n                if (align === 'end') {\n                    left = newTargetRect.right - popoverRect.width;\n                }\n                break;\n            case 'right':\n                top = targetMidY - popoverRect.height / 2;\n                left = newTargetRect.right + padding;\n                if (align === 'start') {\n                    top = newTargetRect.top;\n                }\n                if (align === 'end') {\n                    top = newTargetRect.bottom - popoverRect.height;\n                }\n                break;\n            default:\n                break;\n        }\n        return { top: top, left: left };\n    };\n    Popover.prototype.createContainer = function () {\n        var _a = this.props, containerStyle = _a.containerStyle, containerClassName = _a.containerClassName;\n        var container = window.document.createElement('div');\n        container.style.overflow = 'hidden';\n        if (containerStyle) {\n            Object.keys(containerStyle).forEach(function (key) {\n                return (container.style[key] = containerStyle[key]);\n            });\n        }\n        container.className = containerClassName;\n        container.style.position = 'absolute';\n        container.style.top = '0';\n        container.style.left = '0';\n        return container;\n    };\n    Popover.prototype.updatePopover = function (isOpen) {\n        if (isOpen && this.targetRef) {\n            if (!this.popoverDiv || !this.popoverDiv.parentNode) {\n                var transitionDuration = this.props.transitionDuration;\n                this.popoverDiv = this.createContainer();\n                this.popoverDiv.style.opacity = '0';\n                this.popoverDiv.style.transition = \"opacity \" + transitionDuration + \"s\";\n            }\n            window.addEventListener('resize', this.onResize);\n            window.addEventListener('click', this.onClick);\n            this.renderPopover();\n        }\n        else {\n            this.removePopover();\n        }\n    };\n    Popover.prototype.startTargetPositionListener = function (checkInterval) {\n        var _this = this;\n        if (!this.targetPositionIntervalHandler) {\n            this.targetPositionIntervalHandler = window.setInterval(function () {\n                var newTargetRect = _this.targetRef.current.getBoundingClientRect();\n                if (util_1.targetPositionHasChanged(_this.targetRect, newTargetRect)) {\n                    _this.renderPopover();\n                }\n                _this.targetRect = newTargetRect;\n            }, checkInterval);\n        }\n    };\n    Popover.prototype.removePopover = function () {\n        var _this = this;\n        // this should now be a callback to handle event listening upon portal disappearance\n        var _a = this.props, transitionDuration = _a.transitionDuration, isOpen = _a.isOpen;\n        if (this.popoverDiv) {\n            this.popoverDiv.style.opacity = '0';\n        }\n        var remove = function () {\n            if (_this.willUnmount || !isOpen || !_this.popoverDiv.parentNode) {\n                window.clearInterval(_this.targetPositionIntervalHandler);\n                window.removeEventListener('resize', _this.onResize);\n                window.removeEventListener('click', _this.onClick);\n                _this.targetPositionIntervalHandler = undefined;\n                _this.setState({ isTransitioningToClosed: false });\n            }\n        };\n        if (!this.willUnmount) {\n            this.removePopoverTimeout = window.setTimeout(remove, (transitionDuration || util_1.Constants.FADE_TRANSITION) * 1000);\n        }\n        else {\n            remove();\n        }\n    };\n    Popover.prototype.renderPopover = function (positionIndex) {\n        var _this = this;\n        if (positionIndex === void 0) { positionIndex = 0; }\n        if (positionIndex >= this.positionOrder.length) {\n            return;\n        }\n        this.renderWithPosition({\n            position: this.positionOrder[positionIndex],\n            targetRect: this.targetRef.current.getBoundingClientRect(),\n        }, function (violation, rect) {\n            var _a;\n            var _b = _this.props, disableReposition = _b.disableReposition, contentLocation = _b.contentLocation, contentDestination = _b.contentDestination;\n            if (violation && !disableReposition && !(typeof contentLocation === 'object')) {\n                _this.renderPopover(positionIndex + 1);\n            }\n            else {\n                var _c = _this.props, contentLocation_1 = _c.contentLocation, align = _c.align;\n                var _d = _this.getNudgedPopoverPosition(rect), nudgedTop = _d.top, nudgedLeft = _d.left;\n                var rectTop = rect.top, rectLeft = rect.left;\n                var position = _this.positionOrder[positionIndex];\n                var _e = disableReposition\n                    ? { top: rectTop, left: rectLeft }\n                    : { top: nudgedTop, left: nudgedLeft }, top_1 = _e.top, left = _e.left;\n                if (contentLocation_1) {\n                    var targetRect = _this.targetRef.current.getBoundingClientRect();\n                    var popoverRect = _this.popoverDiv.getBoundingClientRect();\n                    (_a = typeof contentLocation_1 === 'function'\n                        ? contentLocation_1({\n                            targetRect: targetRect,\n                            popoverRect: popoverRect,\n                            position: position,\n                            align: align,\n                            nudgedLeft: nudgedLeft,\n                            nudgedTop: nudgedTop,\n                        })\n                        : contentLocation_1, top_1 = _a.top, left = _a.left);\n                    _this.popoverDiv.style.left = left.toFixed() + \"px\";\n                    _this.popoverDiv.style.top = top_1.toFixed() + \"px\";\n                }\n                else {\n                    var destinationTopOffset = 0;\n                    var destinationLeftOffset = 0;\n                    if (contentDestination) {\n                        var destRect = contentDestination.getBoundingClientRect();\n                        destinationTopOffset = -destRect.top;\n                        destinationLeftOffset = -destRect.left;\n                    }\n                    var absoluteTop = top_1 + window.pageYOffset;\n                    var absoluteLeft = left + window.pageXOffset;\n                    var finalLeft = absoluteLeft + destinationTopOffset;\n                    var finalTop = absoluteTop + destinationLeftOffset;\n                    _this.popoverDiv.style.left = finalLeft.toFixed() + \"px\";\n                    _this.popoverDiv.style.top = finalTop.toFixed() + \"px\";\n                }\n                _this.popoverDiv.style.width = undefined;\n                _this.popoverDiv.style.height = undefined;\n                _this.renderWithPosition({\n                    position: position,\n                    nudgedTop: nudgedTop - rect.top,\n                    nudgedLeft: nudgedLeft - rect.left,\n                    targetRect: _this.targetRef.current.getBoundingClientRect(),\n                    popoverRect: _this.popoverDiv.getBoundingClientRect(),\n                }, function () {\n                    _this.startTargetPositionListener(10);\n                    if (_this.popoverDiv.style.opacity !== '1' && !_this.state.isTransitioningToClosed) {\n                        _this.popoverDiv.style.opacity = '1';\n                    }\n                });\n            }\n        });\n    };\n    Popover.prototype.renderPopoverContent = function () {\n        var _a = this.props, content = _a.content, isOpen = _a.isOpen, contentDestination = _a.contentDestination;\n        var _b = this.state, popoverInfo = _b.popoverInfo, isTransitioningToClosed = _b.isTransitioningToClosed;\n        if ((isOpen || isTransitioningToClosed) && this.popoverDiv && popoverInfo) {\n            var getContent = function (args) {\n                return typeof content === 'function' ? content(args) : content;\n            };\n            return (react_1.default.createElement(PopoverPortal_1.PopoverPortal, { element: this.popoverDiv, container: contentDestination || window.document.body }, getContent(popoverInfo)));\n        }\n        return null;\n    };\n    Popover.prototype.renderChildContent = function () {\n        var children = this.props.children;\n        return typeof children === 'function'\n            ? children(this.targetRef)\n            : react_1.default.cloneElement(children, {\n                ref: this.targetRef,\n            });\n    };\n    Popover.prototype.renderWithPosition = function (_a, callback) {\n        var _this = this;\n        var position = _a.position, _b = _a.nudgedLeft, nudgedLeft = _b === void 0 ? 0 : _b, _c = _a.nudgedTop, nudgedTop = _c === void 0 ? 0 : _c, _d = _a.targetRect, targetRect = _d === void 0 ? util_1.Constants.EMPTY_CLIENT_RECT : _d, _e = _a.popoverRect, popoverRect = _e === void 0 ? util_1.Constants.EMPTY_CLIENT_RECT : _e;\n        var _f = this.props, padding = _f.windowBorderPadding, align = _f.align;\n        var popoverInfo = { position: position, nudgedLeft: nudgedLeft, nudgedTop: nudgedTop, targetRect: targetRect, popoverRect: popoverRect, align: align };\n        if (!util_1.popoverInfosAreEqual(this.state.popoverInfo, popoverInfo)) {\n            window.clearTimeout(this.removePopoverTimeout);\n            this.setState({ popoverInfo: popoverInfo, isTransitioningToClosed: false, internalisOpen: true }, function () {\n                if (_this.willUnmount) {\n                    return;\n                }\n                targetRect = _this.targetRef.current.getBoundingClientRect();\n                popoverRect = _this.popoverDiv.getBoundingClientRect();\n                var _a = _this.getLocationForPosition(position, targetRect, popoverRect), top = _a.top, left = _a.left;\n                callback((position === 'top' && top < padding) ||\n                    (position === 'left' && left < padding) ||\n                    (position === 'right' && left + popoverRect.width > window.innerWidth - padding) ||\n                    (position === 'bottom' && top + popoverRect.height > window.innerHeight - padding), { width: popoverRect.width, height: popoverRect.height, top: top, left: left });\n            });\n        }\n    };\n    Popover.prototype.render = function () {\n        return (react_1.default.createElement(react_1.default.Fragment, null,\n            this.renderChildContent(),\n            this.renderPopoverContent()));\n    };\n    Popover.defaultProps = {\n        padding: util_1.Constants.DEFAULT_PADDING,\n        windowBorderPadding: util_1.Constants.DEFAULT_WINDOW_PADDING,\n        position: DEFAULT_POSITION_ORDER,\n        align: 'center',\n        containerClassName: util_1.Constants.POPOVER_CONTAINER_CLASS_NAME,\n        transitionDuration: util_1.Constants.FADE_TRANSITION,\n    };\n    return Popover;\n}(react_1.default.Component));\nexports.default = Popover;\n"]},"metadata":{},"sourceType":"script"}